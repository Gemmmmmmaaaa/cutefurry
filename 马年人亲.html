<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¹™å·³é©¬å¹´ Â· æ¯›å­©å­ååˆ†æ¼”ç®—ä¸­å¿ƒ</title>
    <style>
        :root {
            --cny-red: #d62828;
            --cny-gold: #f4a261;
            --warm-bg: #fffcf2;
            --text-main: #3d405b;
            --soft-white: #ffffff;
            --transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
        }

        body {
            background-color: var(--warm-bg);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        /* Ambient Decoration */
        .emoji-rain {
            position: fixed;
            top: -50px;
            user-select: none;
            pointer-events: none;
            z-index: 1;
            font-size: 24px;
            animation: fall linear forwards;
            opacity: 0.5;
        }

        @keyframes fall {
            to { transform: translateY(110vh) rotate(360deg); }
        }

        /* App Container */
        .app-card {
            width: 90%;
            max-width: 550px;
            background: var(--soft-white);
            padding: 40px;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(214, 40, 40, 0.08);
            z-index: 10;
            position: relative;
            border: 1px solid rgba(214, 40, 40, 0.05);
            transition: var(--transition);
        }

        .view { display: none; }
        .view.active { display: flex; flex-direction: column; }

        /* Intro View */
        #intro-view { text-align: center; gap: 20px; }
        .horse-icon { font-size: 3.5rem; margin-bottom: 10px; display: block; }
        h1 { color: var(--cny-red); font-size: 1.6rem; letter-spacing: 2px; }
        .intro-text { line-height: 1.8; color: #666; font-size: 0.95rem; margin-bottom: 20px; }
        
        .pick-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .pick-btn {
            background: #fff; border: 2px solid #f8f8f8; border-radius: 16px;
            padding: 15px; cursor: pointer; transition: var(--transition);
            display: flex; flex-direction: column; align-items: center;
        }
        .pick-btn:hover { border-color: var(--cny-red); transform: translateY(-5px); background: #fffaf0; }
        .pick-btn span { font-size: 2rem; margin-bottom: 8px; }
        .pick-btn label { font-weight: bold; color: var(--text-main); cursor: pointer; font-size: 0.9rem; }

        /* Calculator View */
        .calc-header { font-size: 0.9rem; color: #888; margin-bottom: 10px; text-align: center; }
        .display-window {
            min-height: 100px; background: #fdf8f5; border-radius: 16px;
            padding: 20px; margin-bottom: 25px; display: flex; flex-wrap: wrap;
            align-content: center; justify-content: center; gap: 6px;
            border: 1px dashed var(--cny-gold);
        }
        .subject-tag { color: var(--cny-red); font-weight: bold; margin-right: 5px; font-size: 1.1rem; }
        .node-pill {
            background: var(--cny-red); color: #fff; padding: 4px 12px;
            font-size: 0.85rem; border-radius: 100px; animation: pop 0.4s ease;
        }
        .connector { color: var(--cny-red); font-weight: bold; font-size: 0.8rem; opacity: 0.4; }

        .btn-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 30px; }
        .node-btn {
            background: #fff; border: 1px solid #f0f0f0; padding: 12px 0;
            border-radius: 12px; font-size: 0.85rem; cursor: pointer; transition: var(--transition);
        }
        .node-btn:hover { border-color: var(--cny-red); color: var(--cny-red); background: #fff5f5; }

        .btn-primary {
            background: var(--cny-red); color: white; border: none; padding: 16px;
            border-radius: 14px; font-weight: bold; font-size: 1rem; cursor: pointer;
            box-shadow: 0 10px 20px rgba(214, 40, 40, 0.15); transition: var(--transition);
        }
        .btn-primary:hover { letter-spacing: 2px; filter: brightness(1.1); }
        .btn-secondary { background: none; border: 1px solid #ddd; border-radius: 14px; cursor: pointer; color: #888; flex: 1; }

        /* Result View */
        #result-view { text-align: center; }
        .res-label { font-size: 0.85rem; color: #999; margin-bottom: 15px; }
        .res-chain-preview { font-size: 0.9rem; color: var(--cny-gold); margin-bottom: 25px; font-style: italic; }
        .res-main { font-size: 1.8rem; color: var(--cny-red); font-weight: bold; margin-bottom: 30px; line-height: 1.4; }
        .res-bless { font-size: 0.95rem; line-height: 1.8; color: #666; padding: 25px; background: #fff9f9; border-radius: 12px; margin-bottom: 30px; }
        .warm-footer { font-size: 0.85rem; color: #aaa; margin-bottom: 20px; font-style: italic; line-height: 1.6; }

        /* Glitch State */
        .glitch-active { animation: jitter 0.05s infinite; filter: contrast(1.5) invert(0.1); }
        @keyframes jitter { 0% { transform: translate(2px, 2px); } 50% { transform: translate(-2px, -2px); } 100% { transform: translate(1px, -1px); } }
        #warning-overlay {
            position: fixed; inset: 0; z-index: 1000; background: rgba(214, 40, 40, 0.98);
            display: none; align-items: center; justify-content: center; color: white;
            font-size: 4rem; font-weight: 900; text-align: center; padding: 20px;
        }

        @keyframes pop { from { transform: scale(0.4); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body>

    <div id="warning-overlay">ä½ è¸é©¬å¹²å•¥å‘¢ï¼Ÿ</div>

    <div class="app-card">
        <!-- 1. Intro View -->
        <div id="intro-view" class="view active">
            <span class="horse-icon">ğŸ</span>
            <h1>é©¬å¹´æ¯›å­©å­ååˆ†æ¼”ç®—</h1>
            <p class="intro-text">
                åœ¨è¿™ä¸ªå¥”è…¾çš„ä¹™å·³å¹´ï¼Œ<br>
                è®©æˆ‘ä»¬ä¸ºå®¶é‡Œçš„æ¯›èŒ¸èŒ¸ã€ç¾½çµçµæˆå‘˜æ¼”ç®—ä¸€ä¸ªæ–°æ˜¥ååˆ†ã€‚<br>
                è¯·å…ˆé€‰æ‹©ä¸»è§’ï¼š
            </p>
            <div class="pick-grid">
                <div class="pick-btn" onclick="startCalc('çŒ«çŒ«', 'ğŸ±')">
                    <span>ğŸ±</span><label>çŒ«çŒ«</label>
                </div>
                <div class="pick-btn" onclick="startCalc('ç‹—ç‹—', 'ğŸ¶')">
                    <span>ğŸ¶</span><label>ç‹—ç‹—</label>
                </div>
                <div class="pick-btn" onclick="startCalc('é¼ é¼ ', 'ğŸ¹')">
                    <span>ğŸ¹</span><label>é¼ é¼ </label>
                </div>
                <div class="pick-btn" onclick="startCalc('å°é¸Ÿ', 'ğŸ¦')">
                    <span>ğŸ¦</span><label>å°é¸Ÿ</label>
                </div>
            </div>
        </div>

        <!-- 2. Calculator View -->
        <div id="calc-view" class="view">
            <div class="calc-header">å®šä¹‰å®ƒåœ¨å®¶åº­ä¸­çš„ä½ç½®</div>
            <div class="display-window" id="node-display"></div>
            <div class="btn-grid">
                <button class="node-btn" onclick="add('çˆ·çˆ·')">çˆ·çˆ·</button>
                <button class="node-btn" onclick="add('å¥¶å¥¶')">å¥¶å¥¶</button>
                <button class="node-btn" onclick="add('å¤–å…¬')">å¤–å…¬</button>
                <button class="node-btn" onclick="add('å¤–å©†')">å¤–å©†</button>
                <button class="node-btn" onclick="add('çˆ¶äº²')">çˆ¶äº²</button>
                <button class="node-btn" onclick="add('æ¯äº²')">æ¯äº²</button>
                <button class="node-btn" onclick="add('å„¿å­')">å„¿å­</button>
                <button class="node-btn" onclick="add('å¥³å„¿')">å¥³å„¿</button>
                <button class="node-btn" onclick="add('å“¥å“¥')">å“¥å“¥</button>
                <button class="node-btn" onclick="add('å§å§')">å§å§</button>
                <button class="node-btn" onclick="add('å¼Ÿå¼Ÿ')">å¼Ÿå¼Ÿ</button>
                <button class="node-btn" onclick="add('å¦¹å¦¹')">å¦¹å¦¹</button>
            </div>
            <div style="display: flex; gap: 10px;">
                <button class="btn-primary" style="flex: 2;" onclick="runCalc()">æ¦‚æ‹¬ååˆ†</button>
                <button class="btn-secondary" onclick="reset()">æ¸…ç©º</button>
            </div>
        </div>

        <!-- 3. Result View -->
        <div id="result-view" class="view">
            <div class="res-label">æ ¹æ®æ¼”ç®—ï¼Œè¿™ä½ç‰¹æ®Šçš„æˆå‘˜æ˜¯ï¼š</div>
            <div class="res-chain-preview" id="final-chain"></div>
            <div class="res-main" id="target-id"></div>
            <div class="res-bless" id="target-bless"></div>
            <p class="warm-footer">ååˆ†è™½ç”±ç®—æ³•æ¦‚æ‹¬ï¼Œ<br>ä½†å®ƒçœ‹å‘ä½ æ—¶çš„çœ¼ç¥ï¼Œæ°¸è¿œæ˜¯å”¯ä¸€çš„çœŸå®ã€‚</p>
            <button class="btn-primary" onclick="backToStart()">æ–°çš„ä¸€å¹´ï¼Œè¯·å¤šå…³ç…§</button>
        </div>
    </div>

    <script>
        let chain = [];
        let subject = '';
        let subjectEmoji = '';
        const LIMIT = 6;
        const emojis = ['ğŸ', 'ğŸ§§', 'âœ¨', 'ğŸ¾', 'ğŸŒ¾', 'ğŸ', 'ğŸ§¨'];

        function createRain() {
            const e = document.createElement('div');
            e.className = 'emoji-rain';
            e.innerText = emojis[Math.floor(Math.random()*emojis.length)];
            e.style.left = Math.random()*100 + 'vw';
            const dur = Math.random()*3 + 4;
            e.style.animationDuration = dur + 's';
            document.body.appendChild(e);
            setTimeout(()=>e.remove(), dur*1000);
        }
        setInterval(createRain, 500);

        function showView(viewId) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.getElementById(viewId + '-view').classList.add('active');
        }

        function startCalc(type, emoji) {
            subject = type;
            subjectEmoji = emoji;
            chain = [];
            render();
            showView('calc');
        }

        function add(val) {
            if (chain.length >= LIMIT) {
                const overlay = document.getElementById('warning-overlay');
                document.body.classList.add('glitch-active');
                overlay.style.display = 'flex';
                setTimeout(() => {
                    document.body.classList.remove('glitch-active');
                    overlay.style.display = 'none';
                    reset();
                }, 1200);
                return;
            }
            chain.push(val);
            render();
        }

        function render() {
            const d = document.getElementById('node-display');
            if (chain.length === 0) {
                d.innerHTML = `<span class="subject-tag">${subjectEmoji} ${subject}</span> <span style="color: #ccc;">å®ƒæ˜¯æˆ‘çš„...</span>`;
                return;
            }
            let html = `<span class="subject-tag">${subjectEmoji} ${subject}</span> <span class="connector">æ˜¯</span> `;
            html += chain.map((n, i) => 
                `<span class="node-pill">${n}</span>${i < chain.length - 1 ? '<span class="connector">çš„</span>' : ''}`
            ).join('');
            d.innerHTML = html;
        }

        function reset() {
            chain = [];
            render();
        }

        function backToStart() {
            showView('intro');
        }

        const abstractOutcomes = {
            'çŒ«çŒ«': [
                "ä¸€ä½æ‹’ç»æ‰¿è®¤åœ°å¿ƒå¼•åŠ›çš„ã€é«˜ç»´çŒ«ç§‘é•¿è¾ˆã€‘",
                "åœ¨è‰åŸè¿·å®«ä¸­å®ˆæŠ¤ä½ å‘é™…çº¿çš„ã€è‚‰å«ç¥­å¸ã€‘",
                "ç”±äºè¡€è„‰è·¨åº¦è¿‡å¤§è€Œåç¼©æˆçš„ã€èƒ¡é¡»è§‚æµ‹å‘˜ã€‘",
                "ä¹™å·³å¹´é—´å”¯ä¸€æœ‰æƒåœ¨å…¨å®¶ç¦é‡Œã€å…¬ç„¶æ‰“ç›¹çš„é¢†è¢–ã€‘",
                "è·¨è¶Šè¾ˆåˆ†æ·é”ã€ç»ˆæ—¥ç ”ç©¶â€˜çŒ«æ­¥åŠ›å­¦â€™çš„ã€çµé­‚æ•æ‰‹ã€‘"
            ],
            'ç‹—ç‹—': [
                "ä¸€ä½åœ¨èµ›é©¬åœºä¸Šè¯•å›¾æ•™é©¬æ‘‡å°¾å·´çš„ã€çŠ¬ç³»å¯¼å¸ˆã€‘",
                "ä½ ä¼¦ç†å®‡å®™é‡Œæœ€ä¸å®‰åˆ†ã€é©¬åŠ›åè¶³çš„ã€å¿«ä¹èƒ½é‡æºã€‘",
                "åœ¨é™¤å¤•å¤œè´Ÿè´£æ¶ˆç­æ‰€æœ‰â€˜ä¸å¼€å¿ƒå› æœâ€™çš„ã€å°¾å·´ç‰¹å·¥ã€‘",
                "ä¸€ä½ç”±äºè¾ˆåˆ†å¤ªè¿œã€å¹²ç®—ç›´æ¥æ™‹å‡ä¸ºã€è‰åŸå·¡è§†å‘˜ã€‘çš„ç‹—å­",
                "è¢«å®—æ³•åˆ¶è¯¯ä¼¤ä½†ä¾ç„¶åšæŒç”¨çƒ­è¯šæ²»æ„ˆä½ çš„ã€è‚‰å«è‚¡ä¸œã€‘"
            ],
            'é¼ é¼ ': [
                "ä¸€ä½ç”±äºå­˜åœ¨æ„Ÿè¿‡äºå¾®å°è€Œè¿›å…¥ã€é‡å­çŠ¶æ€çš„éšè—äº²æˆšã€‘",
                "åœ¨ç“œå­å£³ä¸æ¢¦å¢ƒä¹‹é—´å¾€è¿”çš„ã€å¾®å‹å› æœæ¬è¿å·¥ã€‘",
                "ä¹™å·³é©¬å¹´é‡Œæœ€å…·â€˜åå·®é©¬åŠ›â€™çš„ã€è…®å¸®å­å‚¨è“„å‘˜ã€‘",
                "ç”±äºè¡€è„‰æµ“åº¦é«˜åº¦å‹ç¼©è€Œæˆçš„ã€æ¯›èŒ¸èŒ¸å¥‡ç‚¹ã€‘",
                "åœ¨æ—è°±è¾¹ç¼˜ä¸æ–­è¯•æ¢ã€æœ€ç»ˆé€šè¿‡å¯çˆ±å¤ºæƒçš„ã€è¿·ä½ å®¶é•¿ã€‘"
            ],
            'å°é¸Ÿ': [
                "ä¸€ä½ç«™åœ¨é«˜å¤„å†·çœ¼è§‚å¯Ÿäººç±»ä¼¦ç†çš„ã€ç¾½çµè§‚å¯Ÿå‘˜ã€‘",
                "ä¹™å·³å¹´é—´è´Ÿè´£å‘å¤©ç•Œä¼ é€â€˜æ–°æ˜¥åæ§½â€™çš„ã€ç©ºä¸­ä¿¡ä½¿ã€‘",
                "ç”±äºæ“…é•¿é£è¡Œè€Œè‡ªåŠ¨å›é¿äº†æ‰€æœ‰â€˜è½åœ°æ°´é€†â€™çš„ã€é«˜ç©ºäº²å‹ã€‘",
                "ä¸€ä½ç”±äºå—“é—¨å“äº®è€Œè¢«æ¨é€‰ä¸ºã€æ–°æ˜¥é¦–å¸­æ’­æŠ¥å‘˜ã€‘çš„é¸Ÿè¾ˆ",
                "åœ¨ç¬¼å­/æå¤´æ„å»ºâ€˜ç§äººé©¬åŠ›èƒ½é‡åœºâ€™çš„ã€è‡ªç”±ä¹‹ç¿¼ä»£ç†äººã€‘"
            ]
        };

        const pseudoBlessings = [
            "ã€é©¬å¹´æ¸©æƒ…æç¤ºã€‘æ–°çš„ä¸€å¹´ï¼Œå»ºè®®å¤šæ‘¸æ‘¸/è§‚å¯Ÿå®ƒçš„çŠ¶æ€ã€‚å“ªæ€•ååˆ†å†è’è°¬ï¼Œå®ƒçš„å¿ƒè·³å’Œæ¸©åº¦æ€»æ˜¯æœ€çœŸå®çš„ã€‚",
            "ã€æ–°æ˜¥ç®—åŠ›åé¦ˆã€‘æ¼”ç®—æ˜¾ç¤ºï¼Œä»Šå¹´æ‚¨çš„é©¬åŠ›å°†ç”±è¿™ä½æˆå‘˜æä¾›ã€‚å¦‚æœå®ƒå¤šåƒäº†ä¸€å£é¥­ï¼Œè¯´æ˜æ‚¨çš„å¥½è¿æ­£åœ¨åŠ é€Ÿè¶…è½¦ã€‚",
            "ã€å› æœå°è´´å£«ã€‘åœ¨æ¥ä¸‹æ¥çš„365å¤©é‡Œï¼Œæ— è®ºç”Ÿæ´»å¦‚ä½•â€˜é©¬é©¬è™è™â€™ï¼Œå®ƒçš„é™ªä¼´éƒ½æ˜¯æ‚¨æœ€ç¨³å›ºçš„è¡€è„‰åç›¾ã€‚",
            "ã€é¿é›·æŒ‡å—ã€‘ä»Šå¹´ä¸å®œä¸è¯¥ä½äº²æˆšè®¨è®ºä¸¥è‚ƒçš„å®¶äº§æˆ–å­¦ä¸šï¼Œå»ºè®®ç›´æ¥ç”¨é›¶é£Ÿè¿›è¡Œç‰©ç†æ€§çš„â€˜å› æœç»“ç®—â€™ã€‚"
        ];

        function runCalc() {
            if (chain.length === 0) {
                alert("è¯·å…ˆå®šä¹‰å®ƒçš„ä½ç½®ï¼");
                return;
            }
            const resMain = document.getElementById('target-id');
            const resBless = document.getElementById('target-bless');
            const resChain = document.getElementById('final-chain');
            
            const pool = abstractOutcomes[subject];
            resChain.innerText = `ï¼ˆ${subjectEmoji}${subject} æ˜¯ ${chain.join('çš„')}ï¼‰`;
            resMain.innerText = pool[Math.floor(Math.random() * pool.length)];
            resBless.innerText = pseudoBlessings[Math.floor(Math.random() * pseudoBlessings.length)];
            
            showView('result');
        }
    </script>
</body>
</html>

